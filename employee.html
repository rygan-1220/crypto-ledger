<!DOCTYPE html>
<html>

<head>
    <title>Employee Dashboard - CryptoLedger</title>
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.7.1/dist/vuetify.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@7.2.96/css/materialdesignicons.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        .v-application {
            font-family: 'Roboto', sans-serif;
        }



        .encryption-badge {
            background: linear-gradient(45deg, #00c853, #00e676);
            color: white;
            padding: 2px 8px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 600;
        }

        .status-chip-pending {
            background-color: #FFF3E0 !important;
            color: #F57C00 !important;
        }

        .status-chip-approved {
            background-color: #E8F5E9 !important;
            color: #2E7D32 !important;
        }

        .status-chip-rejected {
            background-color: #FFEBEE !important;
            color: #C62828 !important;
        }
    </style>
</head>

<body>
    <div id="app">
        <v-app>
            <!-- Navigation Drawer -->
            <v-navigation-drawer app permanent color="white" width="260" elevation="1">
                <div class="d-flex align-center pa-4 pl-6">
                    <v-avatar color="purple darken-2" size="40" class="mr-3">
                        <v-icon color="white">mdi-shield-lock</v-icon>
                    </v-avatar>
                    <div>
                        <div class="text-h6 font-weight-bold">CryptoLedger</div>
                        <div class="text-caption grey--text">Employee Portal</div>
                    </div>
                </div>

                <v-divider></v-divider>

                <v-list nav dense class="mt-4 px-4">
                    <v-list-item-group v-model="selectedItem" color="primary">
                        <v-list-item class="mb-2 rounded">
                            <v-list-item-icon>
                                <v-icon>mdi-view-dashboard</v-icon>
                            </v-list-item-icon>
                            <v-list-item-content>
                                <v-list-item-title class="font-weight-medium">Dashboard</v-list-item-title>
                            </v-list-item-content>
                        </v-list-item>
                        <v-list-item class="mb-2 rounded">
                            <v-list-item-icon>
                                <v-icon>mdi-file-document-plus</v-icon>
                            </v-list-item-icon>
                            <v-list-item-content>
                                <v-list-item-title class="font-weight-medium">Submit Reimbursement</v-list-item-title>
                            </v-list-item-content>
                        </v-list-item>
                        <v-list-item class="mb-2 rounded">
                            <v-list-item-icon>
                                <v-icon>mdi-history</v-icon>
                            </v-list-item-icon>
                            <v-list-item-content>
                                <v-list-item-title class="font-weight-medium">History</v-list-item-title>
                            </v-list-item-content>
                        </v-list-item>
                    </v-list-item-group>
                </v-list>

                <template v-slot:append>
                    <div class="pa-4">
                        <v-card class="rounded pa-3 mb-3" color="blue lighten-5" elevation="0">
                            <div class="d-flex align-center">
                                <v-icon color="success" class="mr-2">mdi-shield-check</v-icon>
                                <div>
                                    <div class="caption font-weight-bold">E2E Encryption Active</div>
                                    <div class="caption grey--text text--darken-1">K_real enabled</div>
                                </div>
                            </div>
                        </v-card>
                        <v-btn block color="error" text large href="index.html">
                            <v-icon left>mdi-logout</v-icon> Logout
                        </v-btn>
                    </div>
                </template>
            </v-navigation-drawer>

            <!-- App Bar -->
            <v-app-bar app color="white" elevation="0"
                style="border-bottom: 1px solid #e0e0e0 !important; height: 64px;">
                <v-toolbar-title class="font-weight-bold text-h6 ml-2">
                    {{ pageTitle }}
                </v-toolbar-title>
                <v-spacer></v-spacer>
                <div class="d-flex align-center mr-4">
                    <v-btn icon class="mr-2">
                        <v-badge color="error" content="2" overlap>
                            <v-icon>mdi-bell-outline</v-icon>
                        </v-badge>
                    </v-btn>
                    <v-avatar color="grey lighten-4" size="40" class="mr-3">
                        <v-icon color="primary">mdi-account</v-icon>
                    </v-avatar>
                    <div class="d-none d-sm-block text-right">
                        <div class="subtitle-2 font-weight-bold black--text mb-0">{{ currentUser.name }}</div>
                        <div class="caption grey--text mt-0">{{ currentUser.email }}</div>
                    </div>
                </div>
            </v-app-bar>

            <!-- Main Content -->
            <v-main class="grey lighten-4">
                <v-container class="pa-6" fluid>
                    <!-- Dashboard Page -->
                    <div v-if="selectedItem === 0">
                        <!-- Stats Row -->
                        <v-row class="mb-4">
                            <v-col cols="12" sm="6" md="3">
                                <v-card class="pa-2" elevation="0">
                                    <v-list-item three-line>
                                        <v-list-item-content>
                                            <div class="overline mb-4 grey--text">Total Submitted</div>
                                            <v-list-item-title class="text-h4 font-weight-bold primary--text mb-1">
                                                RM {{ stats.total.toLocaleString() }}
                                            </v-list-item-title>
                                        </v-list-item-content>
                                        <v-list-item-avatar tile size="80" color="blue lighten-5" class="rounded">
                                            <v-icon x-large color="primary">mdi-cash-multiple</v-icon>
                                        </v-list-item-avatar>
                                    </v-list-item>
                                </v-card>
                            </v-col>
                            <v-col cols="12" sm="6" md="3">
                                <v-card class="pa-2" elevation="0">
                                    <v-list-item three-line>
                                        <v-list-item-content>
                                            <div class="overline mb-4 grey--text">Pending Approval</div>
                                            <v-list-item-title class="text-h4 font-weight-bold orange--text mb-1">
                                                {{ stats.pending }}
                                            </v-list-item-title>
                                        </v-list-item-content>
                                        <v-list-item-avatar tile size="80" color="orange lighten-5" class="rounded">
                                            <v-icon x-large color="orange">mdi-clock-outline</v-icon>
                                        </v-list-item-avatar>
                                    </v-list-item>
                                </v-card>
                            </v-col>
                            <v-col cols="12" sm="6" md="3">
                                <v-card class="pa-2" elevation="0">
                                    <v-list-item three-line>
                                        <v-list-item-content>
                                            <div class="overline mb-4 grey--text">Approved This Month</div>
                                            <v-list-item-title class="text-h4 font-weight-bold success--text mb-1">
                                                {{ stats.approved }}
                                            </v-list-item-title>
                                        </v-list-item-content>
                                        <v-list-item-avatar tile size="80" color="green lighten-5" class="rounded">
                                            <v-icon x-large color="success">mdi-check-circle</v-icon>
                                        </v-list-item-avatar>
                                    </v-list-item>
                                </v-card>
                            </v-col>
                            <v-col cols="12" sm="6" md="3">
                                <v-card class="pa-2" elevation="0">
                                    <v-list-item three-line>
                                        <v-list-item-content>
                                            <div class="overline mb-4 grey--text">Rejected</div>
                                            <v-list-item-title class="text-h4 font-weight-bold error--text mb-1">
                                                {{ stats.rejected }}
                                            </v-list-item-title>
                                        </v-list-item-content>
                                        <v-list-item-avatar tile size="80" color="red lighten-5" class="rounded">
                                            <v-icon x-large color="error">mdi-close-circle</v-icon>
                                        </v-list-item-avatar>
                                    </v-list-item>
                                </v-card>
                            </v-col>
                        </v-row>

                        <!-- Quick Action -->
                        <v-row class="mb-4">
                            <v-col cols="12">
                                <v-card class="pa-6" elevation="0">
                                    <div class="d-flex align-center">
                                        <div class="flex-grow-1">
                                            <h3 class="text-h6 font-weight-bold mb-2">Submit a new reimbursement</h3>
                                            <p class="caption grey--text mb-0">Quick and secure submission process</p>
                                        </div>
                                        <v-btn x-large color="primary" depressed class="px-8" @click="selectedItem = 1">
                                            <v-icon left>mdi-plus-circle</v-icon>
                                            Submit New Request
                                        </v-btn>
                                    </div>
                                </v-card>
                            </v-col>
                        </v-row>

                        <!-- Recent Activity -->
                        <v-row>
                            <v-col cols="12">
                                <v-card class="rounded-card" elevation="0">
                                    <v-toolbar flat color="white" class="px-4 py-2" height="auto">
                                        <div>
                                            <div class="text-h6 font-weight-bold">Recent Activity</div>
                                            <div class="caption grey--text">Your latest reimbursement submissions</div>
                                        </div>
                                    </v-toolbar>
                                    <v-divider></v-divider>
                                    <v-timeline dense class="pa-6">
                                        <v-timeline-item v-for="item in recentActivity" :key="item.id"
                                            :color="item.status === 'approved' ? 'success' : item.status === 'rejected' ? 'error' : 'orange'"
                                            small>
                                            <div class="d-flex justify-space-between align-center">
                                                <div>
                                                    <div class="font-weight-bold">{{ item.description }}</div>
                                                    <div class="caption grey--text">RM {{ item.amount.toLocaleString()
                                                        }} • {{ item.category }} • {{ item.date }}</div>
                                                </div>
                                                <v-chip small :class="'status-chip-' + item.status"
                                                    class="font-weight-medium">
                                                    {{ item.status.toUpperCase() }}
                                                </v-chip>
                                            </div>
                                        </v-timeline-item>
                                    </v-timeline>
                                </v-card>
                            </v-col>
                        </v-row>
                    </div>

                    <!-- Submit Reimbursement Page -->
                    <div v-if="selectedItem === 1">
                        <v-row>
                            <v-col cols="12" md="8">
                                <v-card class="rounded-card" elevation="0">
                                    <v-toolbar flat color="white" class="px-4 py-2" height="auto">
                                        <div>
                                            <div class="text-h6 font-weight-bold">Submit New Reimbursement</div>
                                            <div class="caption grey--text">All data will be encrypted.</div>
                                        </div>
                                    </v-toolbar>
                                    <v-divider></v-divider>
                                    <v-card-text class="pa-6">
                                        <v-form>
                                            <v-row>
                                                <v-col cols="12">
                                                    <div class="mb-4">
                                                        <div class="subtitle-2 font-weight-bold mb-2">Receipt Upload
                                                        </div>
                                                        <v-card outlined class="pa-8 text-center"
                                                            style="border: 2px dashed #ccc; cursor: pointer;">
                                                            <v-icon size="60"
                                                                color="grey lighten-1">mdi-cloud-upload</v-icon>
                                                            <div class="mt-2 grey--text">Drag and drop receipt here or
                                                                click to browse</div>
                                                            <div class="caption grey--text">Supported: PDF, JPG, PNG
                                                                (Max 5MB)</div>
                                                        </v-card>
                                                    </div>
                                                </v-col>
                                                <v-col cols="12" md="6">
                                                    <v-text-field v-model="form.vendor" label="Vendor Name *" outlined
                                                        dense placeholder="e.g., Adobe Systems"
                                                        prepend-inner-icon="mdi-store"></v-text-field>
                                                </v-col>
                                                <v-col cols="12" md="6">
                                                    <v-text-field v-model="form.amount" label="Amount (RM) *" outlined
                                                        dense type="number" placeholder="0.00"
                                                        prepend-inner-icon="mdi-currency-usd"></v-text-field>
                                                </v-col>
                                                <v-col cols="12">
                                                    <v-textarea v-model="form.description" label="Description *"
                                                        outlined dense rows="3"
                                                        placeholder="Describe the purpose of this reimbursement"
                                                        prepend-inner-icon="mdi-text"></v-textarea>
                                                </v-col>
                                                <v-col cols="12" md="6">
                                                    <v-select v-model="form.project" :items="projects" item-text="name"
                                                        item-value="id" label="Project *" outlined dense
                                                        prepend-inner-icon="mdi-folder"></v-select>
                                                </v-col>
                                                <v-col cols="12" md="6">
                                                    <v-select v-model="form.category" :items="categories"
                                                        label="Category *" outlined dense
                                                        prepend-inner-icon="mdi-tag"></v-select>
                                                </v-col>
                                                <v-col cols="12" md="6">
                                                    <v-menu v-model="dateMenu" :close-on-content-click="false"
                                                        transition="scale-transition" offset-y min-width="auto">
                                                        <template v-slot:activator="{ on, attrs }">
                                                            <v-text-field v-model="form.date" label="Date *"
                                                                prepend-inner-icon="mdi-calendar" readonly outlined
                                                                dense v-bind="attrs" v-on="on"></v-text-field>
                                                        </template>
                                                        <v-date-picker v-model="form.date"
                                                            @input="dateMenu = false"></v-date-picker>
                                                    </v-menu>
                                                </v-col>
                                                <v-col cols="12" md="6">
                                                    <v-text-field :value="currentUser.dept_name" label="Department"
                                                        outlined dense readonly
                                                        prepend-inner-icon="mdi-office-building"></v-text-field>
                                                </v-col>
                                            </v-row>
                                        </v-form>
                                    </v-card-text>
                                    <v-divider></v-divider>
                                    <v-card-actions class="pa-4">
                                        <v-spacer></v-spacer>
                                        <v-btn text color="grey darken-1" class="px-4" @click="resetForm">Cancel</v-btn>
                                        <v-btn color="primary" depressed class="px-8" @click="submitReimbursement">
                                            <v-icon left>mdi-lock</v-icon>
                                            Encrypt & Submit
                                        </v-btn>
                                    </v-card-actions>
                                </v-card>
                            </v-col>
                            <v-col cols="12" md="4">
                                <v-card class="mb-4" elevation="0" color="blue lighten-5">
                                    <v-card-text class="pa-4">
                                        <div class="d-flex align-center mb-3">
                                            <v-icon color="primary" class="mr-2">mdi-information</v-icon>
                                            <div class="font-weight-bold">Approval Process</div>
                                        </div>
                                        <v-timeline dense>
                                            <v-timeline-item color="primary" small>
                                                <div class="caption">
                                                    <div class="font-weight-bold">Step 1: Department Manager</div>
                                                    <div class="grey--text text--darken-2">Your manager will review and
                                                        approve</div>
                                                </div>
                                            </v-timeline-item>
                                            <v-timeline-item color="success" small>
                                                <div class="caption">
                                                    <div class="font-weight-bold">Step 2: Finance Manager</div>
                                                    <div class="grey--text text--darken-2">Final approval and processing
                                                    </div>
                                                </div>
                                            </v-timeline-item>
                                            <v-timeline-item color="info" small>
                                                <div class="caption">
                                                    <div class="font-weight-bold">Step 3: Completed</div>
                                                    <div class="grey--text text--darken-2">Reimbursement processed</div>
                                                </div>
                                            </v-timeline-item>
                                        </v-timeline>
                                    </v-card-text>
                                </v-card>
                            </v-col>
                        </v-row>
                    </div>

                    <!-- History Page -->
                    <div v-if="selectedItem === 2">
                        <v-row>
                            <v-col cols="12">
                                <v-card class="rounded-card" elevation="0">
                                    <v-toolbar flat color="white" class="px-4 py-2" height="auto">
                                        <div>
                                            <div class="text-h6 font-weight-bold">Reimbursement History</div>
                                            <div class="caption grey--text">All your reimbursement requests</div>
                                        </div>
                                        <v-spacer></v-spacer>
                                        <v-select v-model="statusFilter" :items="statusOptions" label="Filter by Status"
                                            outlined dense hide-details class="mr-4" style="max-width: 200px"
                                            background-color="grey lighten-5"></v-select>
                                        <v-text-field v-model="historySearch" prepend-inner-icon="mdi-magnify"
                                            label="Search..." single-line hide-details outlined dense class="mr-4"
                                            style="max-width: 250px" background-color="grey lighten-5"></v-text-field>
                                    </v-toolbar>
                                    <v-divider></v-divider>
                                    <v-data-table :headers="historyHeaders" :items="filteredReimbursements"
                                        :search="historySearch" class="elevation-0" show-expand>
                                        <template v-slot:item.id="{ item }">
                                            <span class="font-weight-bold grey--text text--darken-3">#{{ item.id
                                                }}</span>
                                        </template>

                                        <template v-slot:item.description="{ item }">
                                            <div class="py-2">
                                                <div class="font-weight-medium">{{ item.description }}</div>
                                                <div class="caption grey--text">{{ item.vendor }} • {{ item.project_name
                                                    }}</div>
                                            </div>
                                        </template>

                                        <template v-slot:item.amount="{ item }">
                                            <span class="font-weight-bold">RM {{ item.amount.toLocaleString() }}</span>
                                        </template>

                                        <template v-slot:item.category="{ item }">
                                            <v-chip small label color="blue lighten-5" text-color="primary"
                                                class="font-weight-medium">
                                                {{ item.category }}
                                            </v-chip>
                                        </template>

                                        <template v-slot:item.status="{ item }">
                                            <v-chip small :class="'status-chip-' + item.status"
                                                class="font-weight-medium">
                                                {{ item.status.toUpperCase() }}
                                            </v-chip>
                                        </template>

                                        <template v-slot:expanded-item="{ headers, item }">
                                            <td :colspan="headers.length" class="pa-4 grey lighten-5">
                                                <v-row>
                                                    <v-col cols="12" md="8">
                                                        <div class="mb-2"><strong>Description:</strong> {{
                                                            item.description }}</div>
                                                        <div class="mb-2"><strong>Vendor:</strong> {{ item.vendor }}
                                                        </div>
                                                        <div class="mb-2"><strong>Project:</strong> {{ item.project_name
                                                            }}</div>
                                                        <div class="mb-2"><strong>Submitted:</strong> {{
                                                            item.submitted_date }}</div>
                                                    </v-col>
                                                    <v-col cols="12" md="4">
                                                        <v-card elevation="0">
                                                            <v-card-text>
                                                                <div class="caption grey--text mb-2">Security Status
                                                                </div>
                                                                <div class="d-flex align-center">
                                                                    <v-icon small color="success"
                                                                        class="mr-2">mdi-shield-check</v-icon>
                                                                    <span class="caption">Signature Verified &
                                                                        Encrypted</span>
                                                                </div>
                                                            </v-card-text>
                                                        </v-card>
                                                    </v-col>
                                                </v-row>
                                            </td>
                                        </template>
                                    </v-data-table>
                                </v-card>
                            </v-col>
                        </v-row>
                    </div>
                </v-container>
            </v-main>

            <!-- Snackbar -->
            <v-snackbar v-model="snackbar.show" :color="snackbar.color" top right>
                <v-icon left color="white">{{ snackbar.icon }}</v-icon>
                {{ snackbar.text }}
            </v-snackbar>
        </v-app>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.14/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.7.1/dist/vuetify.js"></script>
    <script src="js/mock-data.js"></script>
    <script src="js/employee.js"></script>
</body>

</html>